const sendWhatsAppOrder = () => {
    if (cart.length === 0) return

    // Validate required fields
    if (orderType === 'delivery') {
        if (!customerName || !customerPhone || !deliveryAddress) {
            alert('âš ï¸ Por favor completa: Nombre, TelÃ©fono y DirecciÃ³n')
            return
        }
    } else if (orderType === 'llevar') {
        if (!customerName || !customerPhone) {
            alert('âš ï¸ Por favor completa: Nombre y TelÃ©fono')
            return
        }
    } else if (orderType === 'mesa') {
        if (!tableNumber) {
            alert('âš ï¸ Por favor indica el nÃºmero de mesa')
            return
        }
    }

    // Order type header
    let orderTypeText = ''
    if (orderType === 'delivery') orderTypeText = 'ðŸšš *DELIVERY*'
    else if (orderType === 'llevar') orderTypeText = 'ðŸ›ï¸ *PARA LLEVAR*'
    else if (orderType === 'mesa') orderTypeText = 'ðŸ½ï¸ *EN MESA*'

    // Products list
    const productsList = cart
        .map(
            (item) =>
                `â€¢ ${item.name} x${item.quantity} - ${config?.currency || 'S/'}${(
                    item.price * item.quantity
                ).toFixed(2)}`
        )
        .join('\\n')

    // Customer info
    let customerInfo = ''
    if (orderType === 'delivery') {
        customerInfo = `\\nðŸ“‹ *DATOS:*\\nNombre: ${customerName}\\nTelÃ©fono: ${customerPhone}\\nDirecciÃ³n: ${deliveryAddress}\\nPago: ${paymentMethod.toUpperCase()}`
        if (observations) customerInfo += `\\nObservaciones: ${observations}`
    } else if (orderType === 'llevar') {
        customerInfo = `\\nðŸ“‹ *DATOS:*\\nNombre: ${customerName}\\nTelÃ©fono: ${customerPhone}`
    } else if (orderType === 'mesa') {
        customerInfo = `\\nðŸ”¢ *MESA:* ${tableNumber}`
    }

    const message = `Â¡Hola! Quiero hacer un pedido:\\n\\n${orderTypeText}\\n\\n${productsList}${customerInfo}\\n\\nðŸ’° *Total: ${config?.currency || 'S/'}${getTotal().toFixed(2)}*`

    const whatsappNumber = config?.whatsappNumber || '51999999999'
    const url = `https://wa.me/${whatsappNumber}?text=${encodeURIComponent(message)}`

    window.open(url, '_blank')
    
    // Reset form
    setShowCart(false)
    setCart([])
    setCustomerName('')
    setCustomerPhone('')
    setDeliveryAddress('')
    setTableNumber('')
    setObservations('')
}
